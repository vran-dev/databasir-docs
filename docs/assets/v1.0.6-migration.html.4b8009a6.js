import{_ as n,o as s,c as a,a as t}from"./app.0318b9b0.js";const p={},e=t(`<h2 id="v1-0-6-\u5347\u7EA7\u6307\u5357" tabindex="-1"><a class="header-anchor" href="#v1-0-6-\u5347\u7EA7\u6307\u5357" aria-hidden="true">#</a> V1.0.6 \u5347\u7EA7\u6307\u5357</h2><h2 id="\u54EA\u4E9B\u7248\u672C\u9700\u8981\u8FC1\u79FB" tabindex="-1"><a class="header-anchor" href="#\u54EA\u4E9B\u7248\u672C\u9700\u8981\u8FC1\u79FB" aria-hidden="true">#</a> \u54EA\u4E9B\u7248\u672C\u9700\u8981\u8FC1\u79FB\uFF1F</h2><p>\u5F53\u524D\u7248\u672C\u4F4E\u4E8E v1.0.6</p><h2 id="\u4E3A\u4EC0\u4E48\u9700\u8981\u8FC1\u79FB" tabindex="-1"><a class="header-anchor" href="#\u4E3A\u4EC0\u4E48\u9700\u8981\u8FC1\u79FB" aria-hidden="true">#</a> \u4E3A\u4EC0\u4E48\u9700\u8981\u8FC1\u79FB\uFF1F</h2><p>V1.0.6 \u5F15\u5165\u4E86\u5143\u6570\u636E\u641C\u7D22\u529F\u80FD\uFF0C\u8BE5\u529F\u80FD\u57FA\u4E8E Mysql \u7684\u5168\u6587\u7D22\u5F15\u5B9E\u73B0\uFF0C\u5386\u53F2\u6570\u636E\u6CA1\u6709\u5EFA\u7ACB\u76F8\u5173\u7D22\u5F15\u4F1A\u51FA\u73B0\u641C\u7D22\u4E0D\u5230\u7684\u60C5\u51B5\u3002</p><p>\u9664\u4E86\u4E00\u6B21\u6027\u8FC1\u79FB\u5916\uFF0C\u5982\u679C\u6709\u4EE5\u4E0B\u64CD\u4F5C\u4E5F\u4F1A\u81EA\u52A8\u5EFA\u7ACB\u7D22\u5F15</p><ul><li>\u66F4\u65B0\u5206\u7EC4\u4FE1\u606F\uFF08\u4EFB\u610F\u5B57\u6BB5\uFF09</li><li>\u66F4\u65B0\u9879\u76EE\u4FE1\u606F\uFF08\u4EFB\u610F\u5B57\u6BB5\uFF09</li><li>\u540C\u6B65\u6570\u636E\u5E93\u6210\u529F\uFF08\u6709\u65B0\u7684\u7248\u672C\u4EA7\u751F\uFF09</li></ul><h2 id="\u5982\u4F55\u8FC1\u79FB" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u8FC1\u79FB" aria-hidden="true">#</a> \u5982\u4F55\u8FC1\u79FB\uFF1F</h2><ol><li>\u90E8\u7F72 v1.0.6 \u7248\u672C\u5E94\u7528\uFF0C\u5E76\u542F\u52A8</li><li>\u767B\u5165\u6570\u636E\u5E93\uFF0C\u6267\u884C\u4EE5\u4E0B\u8FC1\u79FB SQL</li></ol><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- migration group info</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> document_full_text<span class="token punctuation">(</span>group_id<span class="token punctuation">,</span> group_name<span class="token punctuation">,</span> group_description<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token identifier"><span class="token punctuation">\`</span>group<span class="token punctuation">\`</span></span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">\`</span>group<span class="token punctuation">\`</span></span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">\`</span>group<span class="token punctuation">\`</span></span><span class="token punctuation">.</span>description
<span class="token keyword">FROM</span> <span class="token identifier"><span class="token punctuation">\`</span>group<span class="token punctuation">\`</span></span>
         <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> document_full_text dft <span class="token keyword">ON</span> <span class="token identifier"><span class="token punctuation">\`</span>group<span class="token punctuation">\`</span></span><span class="token punctuation">.</span>id <span class="token operator">=</span> dft<span class="token punctuation">.</span>group_id
<span class="token keyword">WHERE</span> dft<span class="token punctuation">.</span>group_id <span class="token operator">IS</span> <span class="token boolean">NULL</span>
  <span class="token operator">AND</span> <span class="token identifier"><span class="token punctuation">\`</span>group<span class="token punctuation">\`</span></span><span class="token punctuation">.</span>deleted <span class="token operator">=</span> <span class="token boolean">FALSE</span><span class="token punctuation">;</span>

<span class="token comment">-- migration project info</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> document_full_text<span class="token punctuation">(</span>group_id<span class="token punctuation">,</span> project_id<span class="token punctuation">,</span> project_name<span class="token punctuation">,</span> project_description<span class="token punctuation">,</span> database_name<span class="token punctuation">,</span> schema_name<span class="token punctuation">,</span>
                               database_type<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> project<span class="token punctuation">.</span>group_id<span class="token punctuation">,</span>
       project<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
       project<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
       project<span class="token punctuation">.</span>description<span class="token punctuation">,</span>
       ds<span class="token punctuation">.</span>database_name<span class="token punctuation">,</span>
       ds<span class="token punctuation">.</span>schema_name<span class="token punctuation">,</span>
       ds<span class="token punctuation">.</span>database_type
<span class="token keyword">FROM</span> project
         <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> document_full_text <span class="token keyword">ON</span> project<span class="token punctuation">.</span>id <span class="token operator">=</span> document_full_text<span class="token punctuation">.</span>project_id
         <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token identifier"><span class="token punctuation">\`</span>group<span class="token punctuation">\`</span></span> g <span class="token keyword">ON</span> project<span class="token punctuation">.</span>group_id <span class="token operator">=</span> g<span class="token punctuation">.</span>id
         <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> data_source ds <span class="token keyword">ON</span> project<span class="token punctuation">.</span>id <span class="token operator">=</span> ds<span class="token punctuation">.</span>project_id
<span class="token keyword">WHERE</span> project<span class="token punctuation">.</span>deleted <span class="token operator">=</span> <span class="token boolean">FALSE</span>
  <span class="token operator">AND</span> g<span class="token punctuation">.</span>deleted <span class="token operator">=</span> <span class="token boolean">FALSE</span>
  <span class="token operator">AND</span> document_full_text<span class="token punctuation">.</span>table_document_id <span class="token operator">IS</span> <span class="token boolean">NULL</span>
  <span class="token operator">AND</span> document_full_text<span class="token punctuation">.</span>project_id <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>


<span class="token comment">-- migration column</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> document_full_text<span class="token punctuation">(</span>group_id<span class="token punctuation">,</span> project_id<span class="token punctuation">,</span> database_document_id<span class="token punctuation">,</span> database_document_version<span class="token punctuation">,</span>
                               table_document_id<span class="token punctuation">,</span> table_column_document_id<span class="token punctuation">,</span> database_name<span class="token punctuation">,</span> schema_name<span class="token punctuation">,</span>
                               database_product_name<span class="token punctuation">,</span> table_name<span class="token punctuation">,</span> table_comment<span class="token punctuation">,</span> col_name<span class="token punctuation">,</span> col_comment<span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> pj<span class="token punctuation">.</span>group_id<span class="token punctuation">,</span>
       pj<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
       dd<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
       dd<span class="token punctuation">.</span>version<span class="token punctuation">,</span>
       td<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
       tcd<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
       ds<span class="token punctuation">.</span>database_type<span class="token punctuation">,</span>
       ds<span class="token punctuation">.</span>schema_name<span class="token punctuation">,</span>
       dd<span class="token punctuation">.</span>product_name<span class="token punctuation">,</span>
       td<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
       td<span class="token punctuation">.</span><span class="token keyword">comment</span><span class="token punctuation">,</span>
       tcd<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
       tcd<span class="token punctuation">.</span><span class="token keyword">comment</span>
<span class="token keyword">FROM</span> table_column_document tcd
         <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> document_full_text dft <span class="token keyword">ON</span> dft<span class="token punctuation">.</span>table_column_document_id <span class="token operator">=</span> tcd<span class="token punctuation">.</span>id
         <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> table_document td <span class="token keyword">ON</span> tcd<span class="token punctuation">.</span>table_document_id <span class="token operator">=</span> td<span class="token punctuation">.</span>id
         <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> database_document dd <span class="token keyword">ON</span> tcd<span class="token punctuation">.</span>database_document_id <span class="token operator">=</span> dd<span class="token punctuation">.</span>id
         <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> project pj <span class="token keyword">ON</span> dd<span class="token punctuation">.</span>project_id <span class="token operator">=</span> pj<span class="token punctuation">.</span>id
         <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> data_source ds <span class="token keyword">ON</span> pj<span class="token punctuation">.</span>id <span class="token operator">=</span> ds<span class="token punctuation">.</span>project_id
<span class="token keyword">WHERE</span> pj<span class="token punctuation">.</span>deleted <span class="token operator">=</span> <span class="token boolean">FALSE</span>
  <span class="token operator">AND</span> dd<span class="token punctuation">.</span>is_archive <span class="token operator">=</span> <span class="token boolean">FALSE</span>
  <span class="token operator">AND</span> dft<span class="token punctuation">.</span>table_column_document_id <span class="token operator">IS</span> <span class="token boolean">NULL</span>
  <span class="token operator">AND</span> dft<span class="token punctuation">.</span>project_id <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">-- update table description;</span>

<span class="token keyword">UPDATE</span> document_full_text
    <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> document_description dd <span class="token keyword">ON</span> document_full_text<span class="token punctuation">.</span>project_id <span class="token operator">=</span> dd<span class="token punctuation">.</span>project_id
<span class="token keyword">SET</span> table_description<span class="token operator">=</span>dd<span class="token punctuation">.</span>content
<span class="token keyword">WHERE</span> dd<span class="token punctuation">.</span>table_name <span class="token operator">=</span> document_full_text<span class="token punctuation">.</span>table_name
  <span class="token operator">AND</span> dd<span class="token punctuation">.</span>project_id <span class="token operator">=</span> document_full_text<span class="token punctuation">.</span>project_id
  <span class="token operator">AND</span> dd<span class="token punctuation">.</span>column_name <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>

<span class="token comment">-- update column description;</span>
<span class="token keyword">UPDATE</span> document_full_text
    <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> document_description dd <span class="token keyword">ON</span> document_full_text<span class="token punctuation">.</span>project_id <span class="token operator">=</span> dd<span class="token punctuation">.</span>project_id
<span class="token keyword">SET</span> col_description<span class="token operator">=</span>dd<span class="token punctuation">.</span>content
<span class="token keyword">WHERE</span> dd<span class="token punctuation">.</span>table_name <span class="token operator">=</span> document_full_text<span class="token punctuation">.</span>table_name
  <span class="token operator">AND</span> dd<span class="token punctuation">.</span>column_name <span class="token operator">=</span> document_full_text<span class="token punctuation">.</span>col_name
  <span class="token operator">AND</span> dd<span class="token punctuation">.</span>project_id <span class="token operator">=</span> document_full_text<span class="token punctuation">.</span>project_id
  <span class="token operator">AND</span> dd<span class="token punctuation">.</span>column_name <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u8FC1\u79FB\u5B8C\u6210</li></ol>`,11),o=[e];function c(l,i){return s(),a("div",null,o)}var d=n(p,[["render",c],["__file","v1.0.6-migration.html.vue"]]);export{d as default};
